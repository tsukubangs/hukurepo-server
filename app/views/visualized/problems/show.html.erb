<h3 class="">困りごと一覧</h3>
<div class="detail-box mg-top-30">
  <div class="card">
    <div class="row">
      <div class="col-sm-7" style="padding-right: 0">
        <div class="d-flex flex-column">
          <div class="d-flex flex-row flex-border">
            <div class="p-3 w-150px">投稿日時</div>
            <div class="p-3"><%= japanese_date(@problem.created_at) %></div>
          </div>
          <div class="d-flex flex-row flex-border">
            <div class="p-3 w-150px">投稿者情報</div>
            <div class="p-3">
              <%= japanese_generation(@problem.user_age) %>
              <%= japanese_gender(@problem.user_gender) %>
              <%= @problem.user_country %>
            </div>
          </div>
          <div class="d-flex flex-row flex-border">
            <div class="p-3 w-150px">投稿場所</div>
            <div class="p-3">茨城県つくば市天王台１−１−１</br>
              （緯度：<%= @problem.latitude %>
                経度：<%= @problem.longitude %>)
            </div>
          </div>
          <div class="d-flex flex-row flex-border">
            <div class="p-3 w-150px">返信対応</div>
            <div class="p-3"><%= reply_status(@problem.responded)%></div>
          </div>
        </div>
      </div>
      <div class="col-sm-5" style="padding-left: 0">
        <% if @problem.latitude.nil? or @problem.longitude.nil? %>
            <div class="no-map">
              <p>位置情報が無いため地図の表示ができませんでした</p>
            </div>
        <% else %>
            <div id="map" style="height: 350px;"></div>
        <% end %>
      </div>
    </div>
  </div>
  <div class="card mg-top-30">
    <div class="card-body">
      <p>投稿内容と返信</p>
      <nav class="nav nav-tabs justify-content-end" id="myTab" role="tablist">
        <a class="nav-item nav-link active" id="nav-japanese-tab" data-toggle="tab" href="#nav-japanese" role="tab" aria-controls="nav-japanese" aria-selected="true">日本語</a>
        <a class="nav-item nav-link" id="nav-english-tab" data-toggle="tab" href="#nav-english" role="tab" aria-controls="nav-english" aria-selected="false">英語</a>
      </nav>
      <div class="tab-content" id="nav-tabContent">
        <div class="d-flex flex-row">
          <div style="width: 40%">
            <% unless @problem.image_url.nil?%>
                <%= image_tag(@problem.image_url, class: "detail-img", alt: "Card image cap")%>
            <% else %>
                <%= image_tag("noimage.jpg", class: "detail-img", alt: "Card image cap")%>
            <% end%>
          </div>
          <div class="tab-pane fade show active" id="nav-japanese" role="tabpanel" aria-labelledby="nav-japanese-tab">日本語</div>
          <div class="tab-pane fade" id="nav-english" role="tabpanel" aria-labelledby="nav-english-tab">英語</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" charset="utf-8">
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
        markers = handler.addMarkers([{"lat": <%=@problem.latitude%>,
                                                 "lng": <%=@problem.longitude%>}]);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
        handler.getMap().setZoom(15);
    });
</script>
